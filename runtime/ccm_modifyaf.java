
package macro;
import java.util.*;
import star.common.*;
import star.base.neo.*;
import star.cadmodeler.*;

public class ccm_modifyaf extends StarMacro {
  public void execute() {
    execute0();
  }
  private void execute0() {
    Simulation simulation_0 = getActiveSimulation();
    CadModel cadModel_0 = ((CadModel) simulation_0.get(SolidModelManager.class).getObject("3D-CAD Model 1"));

    ArrayList<double[][]> coords=new ArrayList<double[][]>(){{
        add(new double[][] {{3.65,0.0012,0.0},{3.649081189849313,0.0013774920920414536,0.0},{3.6463256845611887,0.0019090695530962578,0.0},{3.6417362586958792,0.0027921158201579706,0.0},{3.6353175334162016,0.0040225295995529944,0.0},{3.6270759718344197,0.005595091646235114,0.0},{3.6170198725044393,0.007503934693641454,0.0},{3.605159361065868,0.00974307706391077,0.0},{3.5915063800483504,0.01230697470036953,0.0},{3.5760746768464577,0.015191044101730068,0.0},{3.558879789877225,0.01839211008332359,0.0},{3.539939032934283,0.021908737341835835,0.0},{3.5192714777543324,0.025741413075133404,0.0},{3.4968979348135267,0.029892558777447634,0.0},{3.4728409323730833,0.03436636196128978,0.0},{3.4471246937952347,0.03916843198299675,0.0},{3.4197751131523577,0.04430529733844273,0.0},{3.390819729153833,0.04978377373601825,0.0},{3.360287697416905,0.055610242027741244,0.0},{3.3282097611094446,0.061789881935117724,0.0},{3.294618219994182,0.06832591091780942,0.0},{3.2595468979055866,0.0752188772400539,0.0},{3.2230311086921346,0.08246605231859055,0.0},{3.185107620658252,0.09006096009829459,0.0},{3.1458146195417527,0.09799307107115404,0.0},{3.105191670064036,0.10624767642168684,0.0},{3.0632796760917658,0.11480594459498848,0.0},{3.020120839450145,0.12364514937309659,0.0},{2.9757586174292525,0.13273904634481135,0.0},{2.9302376790262414,0.1420583644190379,0.0},{2.8836038599674363,0.15157137156428058,0.0},{2.8359041165556516,0.16124446984224122,0.0},{2.7871864783891667,0.17104277436251483,0.0},{2.7374999999999994,0.18093063404802984,0.0},{2.6868947114601456,0.1908720588019052,0.0},{2.635421568005537,0.20083102726414792,0.0},{2.5831323987284427,0.21077166106389814,0.0},{2.5300798543899594,0.2206582643565133,0.0},{2.476317354405166,0.23045524042939664,0.0},{2.4218990330542938,0.24012690919166094,0.0},{2.3668796849741014,0.24963725942194084,0.0},{2.3113147099843134,0.2589496768744591,0.0},{2.2552600573047044,0.26802669309181165,0.0},{2.1987721692189726,0.2768297996717151,0.0},{2.141907924242148,0.2853193687174591,0.0},{2.084724579848745,0.2934547125170476,0.0},{2.027279714819345,0.30119430469409897,0.0},{1.9696311712636387,0.3084961719674051,0.0},{1.9118369963783293,0.3153184512615025,0.0},{1.853955383998524,0.32162009236996114,0.0},{1.796044616001475,0.3273616728668928,0.0},{1.7381630036216702,0.33250628061663956,0.0},{1.6803688287363605,0.33702041102827096,0.0},{1.6227202851806548,0.3408748218964368,0.0},{1.5652754201512544,0.3440452887289868,0.0},{1.508092075757852,0.34651320801603175,0.0},{1.4512278307810267,0.34826600472357827,0.0},{1.394739942695295,0.34929731283165516,0.0},{1.338685290015686,0.3496069131069077,0.0},{1.283120315025898,0.34920042937870927,0.0},{1.228100966945705,0.3480888020830958,0.0},{1.1736826455948337,0.34628757438514507,0.0},{1.11992014561004,0.34381604045386155,0.0},{1.0668676012715572,0.3406963162462646,0.0},{1.0145784319944622,0.3369523994937972,0.0},{0.963105288539854,0.33260928682334995,0.0},{0.9124999999999994,0.3276922118106273,0.0},{0.8628135216108327,0.32222605838662666,0.0},{0.8140958834443486,0.31623498994141164,0.0},{0.7663961400325634,0.30974231661981433,0.0},{0.7197623209737578,0.30277060293453534,0.0},{0.6742413825707462,0.29534199642991654,0.0},{0.6298791605498547,0.28747873734988033,0.0},{0.5867203239082338,0.2792037907527407,0.0},{0.5448083299359633,0.27054152782803825,0.0},{0.5041853804582467,0.26151837363868546,0.0},{0.4648923793417477,0.2521633351389457,0.0},{0.42696889130786514,0.24250832669281483,0.0},{0.3904531020944126,0.23258822055119707,0.0},{0.355381780005818,0.22244056645147675,0.0},{0.32179023889055514,0.21210494679854597,0.0},{0.2897123025830941,0.20162196044268763,0.0},{0.2591802708461666,0.19103185718711171,0.0},{0.23022488684764228,0.1803728748728558,0.0},{0.20287530620476465,0.16967935910275345,0.0},{0.17715906762691594,0.1589797702882394,0.0},{0.1531020651864728,0.14829470179566676,0.0},{0.13072852224566736,0.13763504488921746,0.0},{0.11006096706571732,0.1270004396900039,0.0},{0.09112021012277458,0.11637814578708643,0.0},{0.0739253231535421,0.10574245132077138,0.0},{0.058493619951649846,0.09505471579854566,0.0},{0.04484063893413214,0.0842641106861885,0.0},{0.03298012749556026,0.07330908457484768,0.0},{0.02292402816558022,0.062119538549378996,0.0},{0.014682466583798503,0.05061965469684723,0.0},{0.008263741304120624,0.03873127910360811,0.0},{0.0036743154388109017,0.026377722821456714,0.0},{0.0009188101506872242,0.01348781261514627,0.0},{0.0,0.0,0.0},{0.0009188101506872242,-0.006443744209857826,0.0},{0.0036743154388111043,-0.013447305861743905,0.0},{0.008263741304120624,-0.020911009406665706,0.0},{0.014682466583798503,-0.028727818326253887,0.0},{0.022924028165580423,-0.0367884061964545,0.0},{0.03298012749556046,-0.04498597617490838,0.0},{0.04484063893413214,-0.05322059104358276,0.0},{0.058493619951649846,-0.06140281326323887,0.0},{0.0739253231535423,-0.06945650198948111,0.0},{0.09112021012277478,-0.07732066852868028,0.0},{0.11006096706571732,-0.08495034978906513,0.0},{0.13072852224566756,-0.09231651729464839,0.0},{0.1531020651864732,-0.09940509377017143,0.0},{0.17715906762691655,-0.10621519699341661,0.0},{0.20287530620476485,-0.11275676888838805,0.0},{0.23022488684764247,-0.11904777471909528,0.0},{0.25918027084616685,-0.12511117154690152,0.0},{0.2897123025830945,-0.13097184648496954,0.0},{0.32179023889055536,-0.13665371421185168,0.0},{0.355381780005818,-0.1421771409657074,0.0},{0.3904531020944132,-0.14755683077786796,0.0},{0.4269688913078653,-0.1528002714897478,0.0},{0.4648923793417477,-0.15790679594234874,0.0},{0.5041853804582469,-0.16286727058689132,0.0},{0.5448083299359641,-0.16766438253116037,0.0},{0.5867203239082339,-0.17227345934702804,0.0},{0.6298791605498549,-0.1766637260335619,0.0},{0.6742413825707471,-0.18079988200985733,0.0},{0.7197623209737586,-0.18464386890166173,0.0},{0.7663961400325635,-0.18815669748759276,0.0},{0.8140958834443488,-0.19130020909389758,0.0},{0.8628135216108329,-0.1940386619429741,0.0},{0.9125000000000004,-0.19634005490178874,0.0},{0.9631052885398542,-0.198177127765958,0.0},{1.0145784319944628,-0.1995280064281402,0.0},{1.0668676012715574,-0.20037649071105154,0.0},{1.1199201456100405,-0.20071201008355052,0.0},{1.173682645594834,-0.20052929596140104,0.0},{1.228100966945706,-0.1998278372476816,0.0},{1.2831203150258985,-0.1986111971059596,0.0},{1.3386852900156863,-0.1968862731500268,0.0},{1.3947399426952953,-0.19466258031856137,0.0},{1.4512278307810271,-0.19195162627360235,0.0},{1.5080920757578522,-0.18876643429724152,0.0},{1.5652754201512546,-0.18512124982866768,0.0},{1.622720285180655,-0.18103144571340232,0.0},{1.6803688287363612,-0.17651361977807986,0.0},{1.7381630036216706,-0.17158585831919856,0.0},{1.7960446160014758,-0.1662681221539952,0.0},{1.853955383998525,-0.16058269938030456,0.0},{1.91183699637833,-0.1545546618869224,0.0},{1.9696311712636392,-0.1482122614386741,0.0},{2.027279714819345,-0.1415872058281709,0.0},{2.0847245798487455,-0.13471476565034018,0.0},{2.1419079242421484,-0.1276336767887774,0.0},{2.198772169218973,-0.12038582141951672,0.0},{2.255260057304705,-0.11301568970292113,0.0},{2.311314709984314,-0.10556964368969478,0.0},{2.366879684974102,-0.09809502266570717,0.0},{2.4218990330542947,-0.09063914369987258,0.0},{2.476317354405166,-0.08324826130182945,0.0},{2.53007985438996,-0.07596655496697333,0.0},{2.5831323987284427,-0.06883521254355328,0.0},{2.6354215680055377,-0.061891670825812484,0.0},{2.686894711460146,-0.05516906304999971,0.0},{2.7375000000000007,-0.04869590696494802,0.0},{2.787186478389167,-0.04249604813891284,0.0},{2.8359041165556516,-0.036588852676970776,0.0},{2.8836038599674367,-0.030989623219974918,0.0},{2.9302376790262423,-0.02571019364105119,0.0},{2.9757586174292534,-0.02075964278401338,0.0},{3.0201208394501453,-0.016145057183437946,0.0},{3.063279676091766,-0.011872267897159035,0.0},{3.1051916700640367,-0.00794648786591831,0.0},{3.145814619541753,-0.0043727836143281455,0.0},{3.185107620658252,-0.0011563281626767038,0.0},{3.2230311086921346,0.001697600181016688,0.0},{3.2595468979055875,0.004183887233381692,0.0},{3.294618219994182,0.00629811153560148,0.0},{3.328209761109445,0.008037299930570046,0.0},{3.360287697416906,0.00940085642685226,0.0},{3.3908197291538333,0.010391592601056694,0.0},{3.4197751131523577,0.01101677463672576,0.0},{3.447124693795235,0.011289094989045729,0.0},{3.4728409323730838,0.011227476308395178,0.0},{3.496897934813527,0.01085762186839746,0.0},{3.5192714777543324,0.010212240027893822,0.0},{3.539939032934283,0.009330889414281285,0.0},{3.558879789877225,0.008259415304532334,0.0},{3.5760746768464577,0.007048974495796664,0.0},{3.5915063800483504,0.005754673948176636,0.0},{3.605159361065868,0.00443387568134809,0.0},{3.6170198725044393,0.0031442448741683645,0.0},{3.6270759718344197,0.0019416380798878941,0.0},{3.6353175334162016,0.0008779424539473047,0.0},{3.6417362586958792,-1.0161724465960163e-06,0.0},{3.6463256845611887,-0.0006573792347139513,0.0},{3.649081189849313,-0.0010628666329500706,0.0},{3.65,-0.0012,0.0}});
    }};
    ArrayList<double[][]> guides=new ArrayList<double[][]>(){{
        add(new double[][] {{0.0,0.0,-0.5},{0.0,0.0,0.5}});
    }};
    String[] afs_name={"af_0"};

    for (int i=0;i<coords.size();i++)
    {
        Sketch3D sketch3D_0 = ((Sketch3D) cadModel_0.getFeature(afs_name[i]));
        sketch3D_0.setAutoPreview(true);
        cadModel_0.allowMakingPartDirty(false);
        // cadModel_0.getFeatureManager().updateModelForEditingFeature(sketch3D_0);
        cadModel_0.getFeatureManager().startSketch3DEdit(sketch3D_0);
        double[][] af_coord=coords.get(i);
        for(int j=0;j<af_coord.length;j++){
            PointSketchPrimitive3D pt = ((PointSketchPrimitive3D) sketch3D_0.getSketchPrimitive3D(String.format("Point %d",j+1)));
            // sketch3D_0.editPointLocal(pt, new DoubleVector(af_coord[j]));
            CoordinateInput coord=pt.getPointInput();
            coord.setVector0(af_coord[j][0]);
            coord.setVector1(af_coord[j][1]);
            coord.setVector2(af_coord[j][2]);
            pt.setPointInput(coord);
        }
        sketch3D_0.setApplyToAllInstances(false);
        sketch3D_0.setExcludedInstancedBodies(new ArrayList<>(Collections.<Body>emptyList()));
        sketch3D_0.setIsBodyGroupCreation(false);
        // sketch3D_0.setAutoPreview(true);
        cadModel_0.getFeatureManager().markDependentNotUptodate(sketch3D_0);
        cadModel_0.allowMakingPartDirty(true);
        sketch3D_0.markFeatureForEdit();
        cadModel_0.allowMakingPartDirty(true);
        cadModel_0.getFeatureManager().stopSketch3DEdit(sketch3D_0, false);
        cadModel_0.getFeatureManager().markDependentNotUptodate(sketch3D_0);
        // cadModel_0.getFeatureManager().updateModelAfterFeatureEdited(sketch3D_0, null);

        Sketch3D sketch3D_1 = ((Sketch3D) cadModel_0.getFeature(String.format("%s_guide",afs_name[i])));
        sketch3D_1.setAutoPreview(true);
        cadModel_0.allowMakingPartDirty(false);
        // cadModel_0.getFeatureManager().updateModelForEditingFeature(sketch3D_1);
        cadModel_0.getFeatureManager().startSketch3DEdit(sketch3D_1);
        double[][] guide_pts=guides.get(i);
        for (int j=0;j<guide_pts.length;j++){
            PointSketchPrimitive3D pt = ((PointSketchPrimitive3D) sketch3D_1.getSketchPrimitive3D(String.format("Point %d",j+1)));
            // sketch3D_1.editPointLocal(pt, new DoubleVector(guide_pts[j]));
            CoordinateInput coord=pt.getPointInput();
            coord.setVector0(guide_pts[j][0]);
            coord.setVector1(guide_pts[j][1]);
            coord.setVector2(guide_pts[j][2]);
            pt.setPointInput(coord);
        }
        sketch3D_1.setApplyToAllInstances(false);
        sketch3D_1.setExcludedInstancedBodies(new ArrayList<>(Collections.<Body>emptyList()));
        sketch3D_1.setIsBodyGroupCreation(false);
        sketch3D_1.setAutoPreview(true);
        cadModel_0.getFeatureManager().markDependentNotUptodate(sketch3D_1);
        cadModel_0.allowMakingPartDirty(true);
        sketch3D_1.markFeatureForEdit();
        cadModel_0.allowMakingPartDirty(true);
        cadModel_0.getFeatureManager().stopSketch3DEdit(sketch3D_1, false);
        cadModel_0.getFeatureManager().markDependentNotUptodate(sketch3D_1);
        // cadModel_0.getFeatureManager().updateModelAfterFeatureEdited(sketch3D_1, null);
    }
    cadModel_0.getFeatureManager().rollForwardToEnd(false);
    cadModel_0.update();
    simulation_0.get(SolidModelManager.class).endEditCadModel(cadModel_0);
  }
}
